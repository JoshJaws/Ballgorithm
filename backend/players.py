import json
import http.client
import numpy as np
import copy

#connect to API-NFL
conn = http.client.HTTPSConnection("v1.american-football.api-sports.io")

headers = {
    'x-rapidapi-host': "v1.american-football.api-sports.io",
    'x-rapidapi-key': "7d2dc831201816acd7bfce6f275ded21"
    }
#Logan's Key 7d2dc831201816acd7bfce6f275ded21
#christian's key c70572c71dea5b9097425435a60d972e
# Given a season and league, pull the teams and store into a dictionary {team_id : team_name}
def get_teams_by_season(league, season):
    conn.request("GET", f"/teams?league={league}&season={season}", headers=headers)

    res = conn.getresponse()
    data = res.read()

    # Data as dict
    data = json.loads(data.decode("utf-8"))

    teams = {}

    for result in range(data['results']):
        team_id = data['response'][result]['id']
        team_name = data['response'][result]['name']
        teams[team_id] = team_name
    try:
        del teams[33]
        del teams[34]
    except:
        return teams
    return teams

# Given a team's ID, pull the players and store into a dictionary {player_id : player_name}
def get_players_by_team(team_id, season):
    conn.request("GET", f"/players?team={team_id}&season={season}", headers=headers)

    res = conn.getresponse()
    data = res.read()

    # Data as dict
    data = json.loads(data.decode("utf-8"))

    players = {}

    #print(data['response'])

    for player in data['response']:
        players[player['id']] = [player['name'], player['position']]

    return players

def get_stats_by_player(player_id, season):
    conn.request("GET", f"/players/statistics?id={player_id}&season={season}", headers=headers)

    # Get the player's stats based on their ID
    res = conn.getresponse()
    data = res.read() 
    data = json.loads(data.decode("utf-8"))

    if (data['results'] == 0):
        return None

    #print(data)

    stats = {}

    # Prints the player's stats divided by category (Rushing, Receiving, Defense, Passing, Scoring, Returning)
    for group in data['response'][0]['teams'][0]['groups']:
        
        stats[group['name']] = {}
        # Print the stats for each category
        for stat in group['statistics']:
            stats[group['name']][stat['name']] = stat['value']
    
    return stats

def print_stats(stats):
    for group, stat in stats.items():
        print(f"\n---{group}---\n")
        for name, value in stat.items():
            print(f"{name}: {value}")

# # Order of stats by position
# Offense: QB, RB, FB, WR, TE, C, G, OT
# Defense: DE, DT, CB, LB, S
# Special: PK, P, LS
def compile_stats(stats):

    # Dictionary containing all stats for each possible position
    # Used to fill in missing stats with 0
    stats_by_position = {'RB': {'Rushing': {'rushing attempts': 0, 'yards': 1, 'yards per rush avg': 2, 'longest rush': 3, 'over 20 yards': 4, 'rushing touchdowns': 5, 'yards per game': 6, 'fumbles': 7, 'fumbles lost': 8, 'rushing first downs': 9}, 'Receiving': {'receptions': 10, 'receiving targets': 11, 'receiving yards': 12, 'yards per reception avg': 13, 'receiving touchdowns': 14, 'longest reception': 15, 'over 20 yards': 16, 'yards per game': 17, 'fumbles': 18, 'fumbles lost': 19, 'yards after catch': 20, 'receiving first downs': 21}, 'Defense': {'unassisted tackles': 22, 'assisted tackles': 23, 'total tackles': 24, 'sacks': 25, 'yards lost on sack': 26, 'tackles for loss': 27, 'passes defended': 28, 'interceptions': 29, 'intercepted returned yards': 30, 'longest interception return': 31, 'interceptions returned for touchdowns': 32, 'forced fumbles': 33, 'fumbles recovered': 34, 'fumbles returned for touchdowns': 35, 'blocked kicks': 36}, 'Scoring': {'rushing touchdowns': 37, 'receiving touchdowns': 38, 'return touchdowns': 39, 'total touchdowns': 40, 'field goals': 41, 'extra points': 42, 'two point conversions': 43, 'total points': 44, 'total points per game': 45}, 'Returning': {'kickoff returned attempts': 46, 'kickoff return yards': 47, 'yards per kickoff avg': 48, 'longes kickoff return': 49, 'kickoff return touchdows': 50, 'punts returned': 51, 'yards returned on punts': 52, 'yards per punt avg': 53, 'longest punt return': 54, 'punt return touchdowns': 55, 'fair catches': 56}}, 'FB': {'Receiving': {'receptions': 0, 'receiving targets': 1, 'receiving yards': 2, 'yards per reception avg': 3, 'receiving touchdowns': 4, 'longest reception': 5, 'over 20 yards': 6, 'yards per game': 7, 'fumbles': 8, 'fumbles lost': 9, 'yards after catch': 10, 'receiving first downs': 11}, 'Defense': {'unassisted tackles': 12, 'assisted tackles': 13, 'total tackles': 14, 'sacks': 15, 'yards lost on sack': 16, 'tackles for loss': 17, 'passes defended': 18, 'interceptions': 19, 'intercepted returned yards': 20, 'longest interception return': 21, 'interceptions returned for touchdowns': 22, 'forced fumbles': 23, 'fumbles recovered': 24, 'fumbles returned for touchdowns': 25, 'blocked kicks': 26}, 'Returning': {'kickoff returned attempts': 27, 'kickoff return yards': 28, 'yards per kickoff avg': 29, 'longes kickoff return': 30, 'kickoff return touchdows': 31, 'punts returned': 32, 'yards returned on punts': 33, 'yards per punt avg': 34, 'longest punt return': 35, 'punt return touchdowns': 36, 'fair catches': 37}}, 'WR': {'Receiving': {'receptions': 0, 'receiving targets': 1, 'receiving yards': 2, 'yards per reception avg': 3, 'receiving touchdowns': 4, 'longest reception': 5, 'over 20 yards': 6, 'yards per game': 7, 'fumbles': 8, 'fumbles lost': 9, 'yards after catch': 10, 'receiving first downs': 11}, 'Defense': {'unassisted tackles': 12, 'assisted tackles': 13, 'total tackles': 14, 'sacks': 15, 'yards lost on sack': 16, 'tackles for loss': 17, 'passes defended': 18, 'interceptions': 19, 'intercepted returned yards': 20, 'longest interception return': 21, 'interceptions returned for touchdowns': 22, 'forced fumbles': 23, 'fumbles recovered': 24, 'fumbles returned for touchdowns': 25, 'blocked kicks': 26}, 'Scoring': {'rushing touchdowns': 27, 'receiving touchdowns': 28, 'return touchdowns': 29, 'total touchdowns': 30, 'field goals': 31, 'extra points': 32, 'two point conversions': 33, 'total points': 34, 'total points per game': 35}, 'Rushing': {'rushing attempts': 36, 'yards': 37, 'yards per rush avg': 38, 'longest rush': 39, 'over 20 yards': 40, 'rushing touchdowns': 41, 'yards per game': 42, 'fumbles': 43, 'fumbles lost': 44, 'rushing first downs': 45}}, 'TE': {'Receiving': {'receptions': 0, 'receiving targets': 1, 'receiving yards': 2, 'yards per reception avg': 3, 'receiving touchdowns': 4, 'longest reception': 5, 'over 20 yards': 6, 'yards per game': 7, 'fumbles': 8, 'fumbles lost': 9, 'yards after catch': 10, 'receiving first downs': 11}, 'Defense': {'unassisted tackles': 12, 'assisted tackles': 13, 'total tackles': 14, 'sacks': 15, 'yards lost on sack': 16, 'tackles for loss': 17, 'passes defended': 18, 'interceptions': 19, 'intercepted returned yards': 20, 'longest interception return': 21, 'interceptions returned for touchdowns': 22, 'forced fumbles': 23, 'fumbles recovered': 24, 'fumbles returned for touchdowns': 25, 'blocked kicks': 26}}, 'C': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'G': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'OT': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'DE': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'DT': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'LB': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'CB': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'S': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'PK': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}, 'Scoring': {'rushing touchdowns': 15, 'receiving touchdowns': 16, 'return touchdowns': 17, 'total touchdowns': 18, 'field goals': 19, 'extra points': 20, 'two point conversions': 21, 'total points': 22, 'total points per game': 23}, 'Kicking': {'field goals made': 24, 'field goals attempts': 25, 'field goals made pct': 26, 'longest goal made': 27, 'field goals from 1 19 yards': 28, 'field goals from 20 29 yards': 29, 'field goals from 30 39 yards': 30, 'field goals from 40 49 yards': 31, 'field goals from 50 yards': 32, 'extra points made': 33, 'extra points attempts': 34, 'extra points made pct': 35}}, 'P': {'Punting': {'punts': 0, 'gross punt yards': 1, 'longest punt': 2, 'gross punting avg': 3, 'net punting avg': 4, 'blocked punts': 5, 'inside 20 yards punt': 6, 'touchbacks': 7, 'fair catches': 8, 'punts returned': 9, 'yards returned on punts': 10, 'yards returned on punts avg': 11}}, 'QB': {'Passing': {'passing attempts': 0, 'completions': 1, 'completion pct': 2, 'yards': 3, 'yards per pass avg': 4, 'yards per game': 5, 'longest pass': 6, 'passing touchdowns': 7, 'passing touchdowns pct': 8, 'interceptions': 9, 'interceptions pct': 10, 'sacks': 11, 'sacked yards lost': 12, 'quaterback rating': 13}, 'Rushing': {'rushing attempts': 14, 'yards': 15, 'yards per rush avg': 16, 'longest rush': 17, 'over 20 yards': 18, 'rushing touchdowns': 19, 'yards per game': 20, 'fumbles': 21, 'fumbles lost': 22, 'rushing first downs': 23}}, 'LS': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}}
    
    compiled_stats = np.array([])
    
    # Fix PK values (28-32) (turn from string to float)
    # These values are written as 'x-y' (x made, y attempted)
    pk = stats['PK']
    for i in range(28,33):
        x,y = stats['PK'][i].split('-')
        x = float(x)
        y = float(y)
        if y == 0:
            stats['PK'][i] = 0
        else:
            stats['PK'][i] = round(x / y,5)

    # Set order of stats by position in the compiled stats array
    order = ['QB', 'RB', 'FB', 'WR', 'TE', 'C', 'G', 'OT', 'DE', 'DT', 'CB', 'LB', 'S', 'PK', 'P', 'LS']
    for position in order:
        # If the position does not have stats, add 0s for each stat
        if position not in stats:
            # Get number of stats for the position
            for group in stats_by_position[position]:
                for stat in stats_by_position[position][group]:
                    compiled_stats = np.append(compiled_stats, 0)
        else:
            compiled_stats = np.append(compiled_stats, stats[position])
    # Replace None values with 0
    compiled_stats[compiled_stats == None] = 0

    return compiled_stats

# Using the dictionary of all stats by position, fill in stats that are within the dictionary
# and fill any missing stats with 0
def get_stats_by_position(team_id, season):
    players = get_players_by_team(team_id, season)

    # Dictionary containing stats by position
    stats_by_position = {'RB': {'Rushing': {'rushing attempts': 0, 'yards': 1, 'yards per rush avg': 2, 'longest rush': 3, 'over 20 yards': 4, 'rushing touchdowns': 5, 'yards per game': 6, 'fumbles': 7, 'fumbles lost': 8, 'rushing first downs': 9}, 'Receiving': {'receptions': 10, 'receiving targets': 11, 'receiving yards': 12, 'yards per reception avg': 13, 'receiving touchdowns': 14, 'longest reception': 15, 'over 20 yards': 16, 'yards per game': 17, 'fumbles': 18, 'fumbles lost': 19, 'yards after catch': 20, 'receiving first downs': 21}, 'Defense': {'unassisted tackles': 22, 'assisted tackles': 23, 'total tackles': 24, 'sacks': 25, 'yards lost on sack': 26, 'tackles for loss': 27, 'passes defended': 28, 'interceptions': 29, 'intercepted returned yards': 30, 'longest interception return': 31, 'interceptions returned for touchdowns': 32, 'forced fumbles': 33, 'fumbles recovered': 34, 'fumbles returned for touchdowns': 35, 'blocked kicks': 36}, 'Scoring': {'rushing touchdowns': 37, 'receiving touchdowns': 38, 'return touchdowns': 39, 'total touchdowns': 40, 'field goals': 41, 'extra points': 42, 'two point conversions': 43, 'total points': 44, 'total points per game': 45}, 'Returning': {'kickoff returned attempts': 46, 'kickoff return yards': 47, 'yards per kickoff avg': 48, 'longes kickoff return': 49, 'kickoff return touchdows': 50, 'punts returned': 51, 'yards returned on punts': 52, 'yards per punt avg': 53, 'longest punt return': 54, 'punt return touchdowns': 55, 'fair catches': 56}}, 'FB': {'Receiving': {'receptions': 0, 'receiving targets': 1, 'receiving yards': 2, 'yards per reception avg': 3, 'receiving touchdowns': 4, 'longest reception': 5, 'over 20 yards': 6, 'yards per game': 7, 'fumbles': 8, 'fumbles lost': 9, 'yards after catch': 10, 'receiving first downs': 11}, 'Defense': {'unassisted tackles': 12, 'assisted tackles': 13, 'total tackles': 14, 'sacks': 15, 'yards lost on sack': 16, 'tackles for loss': 17, 'passes defended': 18, 'interceptions': 19, 'intercepted returned yards': 20, 'longest interception return': 21, 'interceptions returned for touchdowns': 22, 'forced fumbles': 23, 'fumbles recovered': 24, 'fumbles returned for touchdowns': 25, 'blocked kicks': 26}, 'Returning': {'kickoff returned attempts': 27, 'kickoff return yards': 28, 'yards per kickoff avg': 29, 'longes kickoff return': 30, 'kickoff return touchdows': 31, 'punts returned': 32, 'yards returned on punts': 33, 'yards per punt avg': 34, 'longest punt return': 35, 'punt return touchdowns': 36, 'fair catches': 37}}, 'WR': {'Receiving': {'receptions': 0, 'receiving targets': 1, 'receiving yards': 2, 'yards per reception avg': 3, 'receiving touchdowns': 4, 'longest reception': 5, 'over 20 yards': 6, 'yards per game': 7, 'fumbles': 8, 'fumbles lost': 9, 'yards after catch': 10, 'receiving first downs': 11}, 'Defense': {'unassisted tackles': 12, 'assisted tackles': 13, 'total tackles': 14, 'sacks': 15, 'yards lost on sack': 16, 'tackles for loss': 17, 'passes defended': 18, 'interceptions': 19, 'intercepted returned yards': 20, 'longest interception return': 21, 'interceptions returned for touchdowns': 22, 'forced fumbles': 23, 'fumbles recovered': 24, 'fumbles returned for touchdowns': 25, 'blocked kicks': 26}, 'Scoring': {'rushing touchdowns': 27, 'receiving touchdowns': 28, 'return touchdowns': 29, 'total touchdowns': 30, 'field goals': 31, 'extra points': 32, 'two point conversions': 33, 'total points': 34, 'total points per game': 35}, 'Rushing': {'rushing attempts': 36, 'yards': 37, 'yards per rush avg': 38, 'longest rush': 39, 'over 20 yards': 40, 'rushing touchdowns': 41, 'yards per game': 42, 'fumbles': 43, 'fumbles lost': 44, 'rushing first downs': 45}}, 'TE': {'Receiving': {'receptions': 0, 'receiving targets': 1, 'receiving yards': 2, 'yards per reception avg': 3, 'receiving touchdowns': 4, 'longest reception': 5, 'over 20 yards': 6, 'yards per game': 7, 'fumbles': 8, 'fumbles lost': 9, 'yards after catch': 10, 'receiving first downs': 11}, 'Defense': {'unassisted tackles': 12, 'assisted tackles': 13, 'total tackles': 14, 'sacks': 15, 'yards lost on sack': 16, 'tackles for loss': 17, 'passes defended': 18, 'interceptions': 19, 'intercepted returned yards': 20, 'longest interception return': 21, 'interceptions returned for touchdowns': 22, 'forced fumbles': 23, 'fumbles recovered': 24, 'fumbles returned for touchdowns': 25, 'blocked kicks': 26}}, 'C': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'G': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'OT': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'DE': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'DT': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'LB': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'CB': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'S': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}, 'PK': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}, 'Scoring': {'rushing touchdowns': 15, 'receiving touchdowns': 16, 'return touchdowns': 17, 'total touchdowns': 18, 'field goals': 19, 'extra points': 20, 'two point conversions': 21, 'total points': 22, 'total points per game': 23}, 'Kicking': {'field goals made': 24, 'field goals attempts': 25, 'field goals made pct': 26, 'longest goal made': 27, 'field goals from 1 19 yards': 28, 'field goals from 20 29 yards': 29, 'field goals from 30 39 yards': 30, 'field goals from 40 49 yards': 31, 'field goals from 50 yards': 32, 'extra points made': 33, 'extra points attempts': 34, 'extra points made pct': 35}}, 'P': {'Punting': {'punts': 0, 'gross punt yards': 1, 'longest punt': 2, 'gross punting avg': 3, 'net punting avg': 4, 'blocked punts': 5, 'inside 20 yards punt': 6, 'touchbacks': 7, 'fair catches': 8, 'punts returned': 9, 'yards returned on punts': 10, 'yards returned on punts avg': 11}}, 'QB': {'Passing': {'passing attempts': 0, 'completions': 1, 'completion pct': 2, 'yards': 3, 'yards per pass avg': 4, 'yards per game': 5, 'longest pass': 6, 'passing touchdowns': 7, 'passing touchdowns pct': 8, 'interceptions': 9, 'interceptions pct': 10, 'sacks': 11, 'sacked yards lost': 12, 'quaterback rating': 13}, 'Rushing': {'rushing attempts': 14, 'yards': 15, 'yards per rush avg': 16, 'longest rush': 17, 'over 20 yards': 18, 'rushing touchdowns': 19, 'yards per game': 20, 'fumbles': 21, 'fumbles lost': 22, 'rushing first downs': 23}}, 'LS': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 1, 'total tackles': 2, 'sacks': 3, 'yards lost on sack': 4, 'tackles for loss': 5, 'passes defended': 6, 'interceptions': 7, 'intercepted returned yards': 8, 'longest interception return': 9, 'interceptions returned for touchdowns': 10, 'forced fumbles': 11, 'fumbles recovered': 12, 'fumbles returned for touchdowns': 13, 'blocked kicks': 14}}}

    # Dictionary to store the stats for each player
    stats = {}


    # Get the stats for each player
    for player_id, player_info in players.items():
        # Get the stats for each player
        player_stats = get_stats_by_player(player_id, season)

        # If the player has stats and the position isn't in the dictionary, add them
        if player_stats != None and player_info[1] not in stats:

            # Start with an empty list and fill with stats
            stats[player_info[1]] = []

            # For every stat in that position's dictionary, add the stat to the player's stats
            for group in stats_by_position[player_info[1]]:
                # If the group of stats is not in the player's stats, add 0 for all stats in that group
                if group not in player_stats:
                    for stat in stats_by_position[player_info[1]][group]:
                        stats[player_info[1]].append(0)
                    continue
                for stat in stats_by_position[player_info[1]][group]:
                    # Get the player's corresponding stat
                    # If the stat is not in the player's stats, add 0
                    
                    if stat not in player_stats[group]:
                        stats[player_info[1]].append(0)
                    else:
                        value = player_stats[group][stat]
                        # If the value is a string, turn it into a float
                        try:
                            value = float(value.replace(',', ''))
                        except:
                            pass
                        stats[player_info[1]].append(value)
    return stats

#this function will find the average stats for every position in the league for the entire season
def get_average_stats_per_season():
    #holds the average stats per position for each year
    averagesPerYear = {}

    #keeps track of average stat for each position
    average_per_position = {'RB': {'Rushing': {'rushing attempts': 0, 'yards': 0, 'yards per rush avg': 0, 'longest rush': 0, 'over 20 yards': 0, 'rushing touchdowns': 0, 'yards per game': 0, 'fumbles': 0, 'fumbles lost': 0, 'rushing first downs': 0}, 'Receiving': {'receptions': 0, 'receiving targets': 0, 'receiving yards': 0, 'yards per reception avg': 0, 'receiving touchdowns': 0, 'longest reception': 0, 'over 20 yards': 0, 'yards per game': 0, 'fumbles': 0, 'fumbles lost': 0, 'yards after catch': 0, 'receiving first downs': 0}, 'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}, 'Scoring': {'rushing touchdowns': 0, 'receiving touchdowns': 0, 'return touchdowns': 0, 'total touchdowns': 0, 'field goals': 0, 'extra points': 0, 'two point conversions': 0, 'total points': 0, 'total points per game': 0}, 'Returning': {'kickoff returned attempts': 0, 'kickoff return yards': 0, 'yards per kickoff avg': 0, 'longes kickoff return': 0, 'kickoff return touchdows': 0, 'punts returned': 0, 'yards returned on punts': 0, 'yards per punt avg': 0, 'longest punt return': 0, 'punt return touchdowns': 0, 'fair catches': 0}}, 'FB': {'Receiving': {'receptions': 0, 'receiving targets': 0, 'receiving yards': 0, 'yards per reception avg': 0, 'receiving touchdowns': 0, 'longest reception': 0, 'over 20 yards': 0, 'yards per game': 0, 'fumbles': 0, 'fumbles lost': 0, 'yards after catch': 0, 'receiving first downs': 0}, 'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}, 'Returning': {'kickoff returned attempts': 0, 'kickoff return yards': 0, 'yards per kickoff avg': 0, 'longes kickoff return': 0, 'kickoff return touchdows': 0, 'punts returned': 0, 'yards returned on punts': 0, 'yards per punt avg': 0, 'longest punt return': 0, 'punt return touchdowns': 0, 'fair catches': 0}}, 'WR': {'Receiving': {'receptions': 0, 'receiving targets': 0, 'receiving yards': 0, 'yards per reception avg': 0, 'receiving touchdowns': 0, 'longest reception': 0, 'over 20 yards': 0, 'yards per game': 0, 'fumbles': 0, 'fumbles lost': 0, 'yards after catch': 0, 'receiving first downs': 0},'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}, 'Scoring': {'rushing touchdowns': 0, 'receiving touchdowns': 0, 'return touchdowns': 0, 'total touchdowns': 0, 'field goals': 0, 'extra points': 0, 'two point conversions': 0, 'total points': 0, 'total points per game': 0}, 'Rushing': {'rushing attempts': 0, 'yards': 0, 'yards per rush avg': 0, 'longest rush': 0, 'over 20 yards': 0, 'rushing touchdowns': 0, 'yards per game': 0, 'fumbles': 0, 'fumbles lost': 0, 'rushing first downs': 0}}, 'TE': {'Receiving': {'receptions': 0, 'receiving targets': 0, 'receiving yards': 0, 'yards per reception avg': 0, 'receiving touchdowns': 0, 'longest reception': 0, 'over 20 yards': 0, 'yards per game': 0, 'fumbles': 0, 'fumbles lost': 0, 'yards after catch': 0, 'receiving first downs': 0}, 'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'C': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'G': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'OT': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'DE': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'DT': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'LB': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'CB': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'S': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}, 'PK': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}, 'Scoring': {'rushing touchdowns': 0, 'receiving touchdowns': 0, 'return touchdowns': 0, 'total touchdowns': 0, 'field goals': 0, 'extra points': 0, 'two point conversions': 0, 'total points': 0, 'total points per game': 0}, 'Kicking': {'field goals made': 0, 'field goals attempts': 0, 'field goals made pct': 0, 'longest goal made': 0, 'field goals from 1 19 yards': 0, 'field goals from 20 29 yards': 0, 'field goals from 30 39 yards': 0, 'field goals from 40 49 yards': 0, 'field goals from 50 yards': 0, 'extra points made': 0, 'extra points attempts': 0, 'extra points made pct': 0}}, 'P': {'Punting': {'punts': 0, 'gross punt yards': 0, 'longest punt': 0, 'gross punting avg': 0, 'net punting avg': 0, 'blocked punts': 0, 'inside 20 yards punt': 0, 'touchbacks': 0, 'fair catches': 0, 'punts returned': 0, 'yards returned on punts': 0, 'yards returned on punts avg': 0}}, 'QB': {'Passing': {'passing attempts': 0, 'completions': 0, 'completion pct': 0, 'yards': 0, 'yards per pass avg': 0, 'yards per game': 0, 'longest pass': 0, 'passing touchdowns': 0, 'passing touchdowns pct': 0, 'interceptions': 0, 'interceptions pct': 0, 'sacks': 0, 'sacked yards lost': 0, 'quaterback rating': 0}, 'Rushing': {'rushing attempts': 0, 'yards': 0, 'yards per rush avg': 0, 'longest rush': 0, 'over 20 yards': 0, 'rushing touchdowns': 0, 'yards per game': 0, 'fumbles': 0, 'fumbles lost': 0, 'rushing first downs': 0}}, 'LS': {'Defense': {'unassisted tackles': 0, 'assisted tackles': 0, 'total tackles': 0, 'sacks': 0, 'yards lost on sack': 0, 'tackles for loss': 0, 'passes defended': 0, 'interceptions': 0, 'intercepted returned yards': 0, 'longest interception return': 0, 'interceptions returned for touchdowns': 0, 'forced fumbles': 0, 'fumbles recovered': 0, 'fumbles returned for touchdowns': 0, 'blocked kicks': 0}}}
    positionCount = {'QB':0, 'RB':0, 'FB':0, 'WR':0, 'TE':0, 'C':0, 'G':0, 'OT':0, 'DE':0, 'DT':0, 'CB':0, 'LB':0,'S':0, 'PK':0, 'P':0, 'LS':0}

    seasons = [2023]
    #interates through seassons
    for s in seasons:
        averagesPerYear[s] = copy.deepcopy(average_per_position)
        
        teamList = get_teams_by_season(1,s)
        #iterates through each team in NFL
        for teamId in teamList:
            # Get the stats for each player of the team
            players = get_players_by_team(teamId, s)
            #print(s,teamList[teamId])

            for player_id, player_info in players.items():
                
                player_stats = get_stats_by_player(player_id, s)
                #if stats for the player doesnt exist
                if player_stats is not None:
                    positionCount[player_info[1]] = positionCount[player_info[1]] + 1
                    #print(s,teamList[teamId],player_info[0])
                    # Fix PK values (28-32) (turn from string to float)
                    # These values are written as 'x-y' (x made, y attempted)
                    if player_info[1] == 'PK':
                        if 'Kicking' in player_stats and player_stats['Kicking'] is not None:
                            for stat in player_stats['Kicking']:
                                if "-" in player_stats['Kicking'][stat]:
                                        x,y = player_stats['Kicking'][stat].split('-')
                                        x = float(x)
                                        y = float(y)
                                        if y == 0:
                                            player_stats['Kicking'][stat] = 0
                                        else:
                                            player_stats['Kicking'][stat] = round(x / y,5)
                    #for each stats group
                    for group in average_per_position[player_info[1]]:
                        #fills in stats as zero if a player doesn't have a certain stat group
                        if group not in player_stats:
                            player_stats.update({group:{}})
                            for stat in average_per_position[player_info[1]][group]:
                                    player_stats[group][stat] = 0
                            continue
                        else:
                            #goes through each stat and adds it to total
                            for stat in average_per_position[player_info[1]][group]:
                                if stat not in player_stats[group]:
                                    continue
                                else:
                                    value = player_stats[group][stat]
                                    # If the value is a string, turn it into a float
                                    try:
                                        value = float(value.replace(',', ''))
                                    except:
                                        pass
                                    if value is not None:
                                        averagesPerYear[s][player_info[1]][group][stat] = averagesPerYear[s][player_info[1]][group][stat] + value
            print(s,teamList[teamId],positionCount)
        #goes through each stat and divides it by the number of players per position in the league to get the average
        for position in positionCount:
            count = positionCount[position]
            for group in average_per_position[position]:
                for stat in average_per_position[position][group]:
                    if averagesPerYear[s][position][group][stat] == 0:
                        continue
                    else:
                        averagesPerYear[s][position][group][stat] = round(averagesPerYear[s][position][group][stat] / (count * 1.0),5)
        #resets position counts back to 0
        positionCount = positionCount.fromkeys(positionCount,0)
    return averagesPerYear

#this function returns the season years that are supported
#All seasons are only 4-digit keys, so for a league whose season is 2018-2019 the season in the API will be 2018
def getSeasons():
    conn.request("GET", "/seasons", headers=headers)
    
    res = conn.getresponse()
    data = res.read()
    data = json.loads(data)

    seasonList = []

    for year in data["response"]:
        seasonList.append(int(year))
    return seasonList

#this function takes two team IDs and the season and returns the games played between the two teams
def get_head_to_head_games(team_id_1,team_id_2,season):
    conn.request("GET", f"/games?season={season}&h2h={team_id_1}-{team_id_2}", headers=headers)

    # Gets the head to head games for the given season
    res = conn.getresponse()
    data = res.read() 
    data = json.loads(data.decode("utf-8"))

    gameList = {}
    
    #iterates through all the games played and tracks 
    for game in data['response']:
        gameList[game['teams']['home']['name'] + " vs " + game['teams']['away']['name']] = game['scores']
    return gameList

stats = get_average_stats_per_season()
print(stats[2023])
#print(stats[2023])
#compiled_stats = compile_stats(get_stats_by_position(3, 2023))
#print(compiled_stats)
#print(len(compiled_stats))

#{'QB': 43, 'RB': 75, 'FB': 6, 'WR': 113, 'TE': 54, 'C': 9, 'G': 23, 'OT': 16, 'DE': 65, 'DT': 85, 'CB': 125, 'LB': 151, 'S': 85, 'PK': 21, 'P': 20, 'LS': 13}
#2023{'RB': {'Rushing': {'rushing attempts': 76.96, 'yards': 328.42667, 'yards per rush avg': 3.73333, 'longest rush': 24.94667, 'over 20 yards': 1.74667, 'rushing touchdowns': 2.32, 'yards per game': 24.97333, 'fumbles': 0.52, 'fumbles lost': 0.32, 'rushing first downs': 17.09333}, 'Receiving': {'receptions': 15.93333, 'receiving targets': 20.85333, 'receiving yards': 116.6, 'yards per reception avg': 6.55067, 'receiving touchdowns': 0.58667, 'longest reception': 22.48, 'over 20 yards': 1.01333, 'yards per game': 8.968, 'fumbles': 0.14667, 'fumbles lost': 0.08, 'yards after catch': 125.0, 'receiving first downs': 5.16}, 'Defense': {'unassisted tackles': 0.89333, 'assisted tackles': 0.41333, 'total tackles': 1.30667, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.02667, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}, 'Scoring': {'rushing touchdowns': 2.33333, 'receiving touchdowns': 0.58667, 'return touchdowns': 0.0, 'total touchdowns': 2.92, 'field goals': 0.0, 'extra points': 0.0, 'two point conversions': 0.13333, 'total points': 17.78667, 'total points per game': 1.27333}, 'Returning': {'kickoff returned attempts': 1.73333, 'kickoff return yards': 39.2, 'yards per kickoff avg': 7.004, 'longes kickoff return': 9.42667, 'kickoff return touchdows': 0.0, 'punts returned': 0.10667, 'yards returned on punts': 0.48, 'yards per punt avg': 0.16, 'longest punt return': 0.29333, 'punt return touchdowns': 0.0, 'fair catches': 0.06667}}, 'FB': {'Receiving': {'receptions': 5.0, 'receiving targets': 6.0, 'receiving yards': 39.16667, 'yards per reception avg': 6.48333, 'receiving touchdowns': 0.5, 'longest reception': 15.16667, 'over 20 yards': 0.5, 'yards per game': 2.41667, 'fumbles': 0.0, 'fumbles lost': 0.0, 'yards after catch': 22.83333, 'receiving first downs': 2.16667}, 'Defense': {'unassisted tackles': 1.66667, 'assisted tackles': 1.0, 'total tackles': 2.66667, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.16667, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}, 'Returning': {'kickoff returned attempts': 0.5, 'kickoff return yards': 7.16667, 'yards per kickoff avg': 7.16667, 'longes kickoff return': 7.16667, 'kickoff return touchdows': 0.0, 'punts returned': 0.0, 'yards returned on punts': 0.0, 'yards per punt avg': 0.0, 'longest punt return': 0.0, 'punt return touchdowns': 0.0, 'fair catches': 0.0}}, 'WR': {'Receiving': {'receptions': 25.21239, 'receiving targets': 40.9115, 'receiving yards': 318.80531, 'yards per reception avg': 10.16195, 'receiving touchdowns': 1.83186, 'longest reception': 32.27434, 'over 20 yards': 4.54867, 'yards per game': 22.30619, 'fumbles': 0.30088, 'fumbles lost': 0.17699, 'yards after catch': 106.17699, 'receiving first downs': 14.9469}, 'Defense': {'unassisted tackles': 1.0885, 'assisted tackles': 0.23009, 'total tackles': 1.31858, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0177, 'fumbles recovered': 0.0177, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}, 'Scoring': {'rushing touchdowns': 0.10619, 'receiving touchdowns': 1.83186, 'return touchdowns': 0.04425, 'total touchdowns': 1.9823, 'field goals': 0.0, 'extra points': 0.0, 'two point conversions': 0.0708, 'total points': 12.0354, 'total points per game': 0.83805}, 'Rushing': {'rushing attempts': 1.9292, 'yards': 11.90265, 'yards per rush avg': 2.46372, 'longest rush': 5.95575, 'over 20 yards': 0.11504, 'rushing touchdowns': 0.10619, 'yards per game': 0.84425, 'fumbles': 0.02655, 'fumbles lost': 0.00885, 'rushing first downs': 0.59292}}, 'TE': {'Receiving': {'receptions': 23.18519, 'receiving targets': 32.24074, 'receiving yards': 241.68519, 'yards per reception avg': 9.43889, 'receiving touchdowns': 1.48148, 'longest reception': 24.75926, 'over 20 yards': 2.68519, 'yards per game': 16.41481, 'fumbles': 0.22222, 'fumbles lost': 0.12963, 'yards after catch': 115.18519, 'receiving first downs': 11.66667}, 'Defense': {'unassisted tackles': 1.51852, 'assisted tackles': 0.62963, 'total tackles': 2.14815, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.01852, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.03704, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}, 'C': {'Defense': {'unassisted tackles': 0.55556, 'assisted tackles': 0.44444, 'total tackles': 1.0, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}, 'G': {'Defense': {'unassisted tackles': 0.91304, 'assisted tackles': 0.21739, 'total tackles': 1.13043, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}, 'OT': {'Defense': {'unassisted tackles': 0.9375, 'assisted tackles': 0.1875, 'total tackles': 1.125, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}, 'DE': {'Defense': {'unassisted tackles': 12.78462, 'assisted tackles': 9.52308, 'total tackles': 22.30769, 'sacks': 2.76923, 'yards lost on sack': 20.07692, 'tackles for loss': 3.73846, 'passes defended': 1.03077, 'interceptions': 0.01538, 'intercepted returned yards': 0.09231, 'longest interception return': 0.09231, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.41538, 'fumbles recovered': 0.35385, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.12308}}, 'DT': {'Defense': {'unassisted tackles': 11.78824, 'assisted tackles': 11.02353, 'total tackles': 22.81176, 'sacks': 1.69412, 'yards lost on sack': 11.11765, 'tackles for loss': 2.75294, 'passes defended': 0.83529, 'interceptions': 0.04706, 'intercepted returned yards': 0.08235, 'longest interception return': 0.08235, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.29412, 'fumbles recovered': 0.25882, 'fumbles returned for touchdowns': 0.02353, 'blocked kicks': 0.03529}}, 'LB': {'Defense': {'unassisted tackles': 23.12583, 'assisted tackles': 15.43709, 'total tackles': 38.56291, 'sacks': 1.69536, 'yards lost on sack': 11.46358, 'tackles for loss': 3.18543, 'passes defended': 1.48344, 'interceptions': 0.23841, 'intercepted returned yards': 3.71523, 'longest interception return': 3.06623, 'interceptions returned for touchdowns': 0.01987, 'forced fumbles': 0.49007, 'fumbles recovered': 0.27152, 'fumbles returned for touchdowns': 0.00662, 'blocked kicks': 0.00662}}, 'CB': {'Defense': {'unassisted tackles': 21.552, 'assisted tackles': 6.576, 'total tackles': 28.128, 'sacks': 0.12, 'yards lost on sack': 0.712, 'tackles for loss': 1.032, 'passes defended': 3.936, 'interceptions': 0.576, 'intercepted returned yards': 8.128, 'longest interception return': 6.608, 'interceptions returned for touchdowns': 0.104, 'forced fumbles': 0.264, 'fumbles recovered': 0.176, 'fumbles returned for touchdowns': 0.016, 'blocked kicks': 0.0}}, 'S': {'Defense': {'unassisted tackles': 30.0, 'assisted tackles': 13.38824, 'total tackles': 43.38824, 'sacks': 0.43529, 'yards lost on sack': 3.52941, 'tackles for loss': 1.67059, 'passes defended': 3.25882, 'interceptions': 1.07059, 'intercepted returned yards': 16.87059, 'longest interception return': 12.31765, 'interceptions returned for touchdowns': 0.10588, 'forced fumbles': 0.36471, 'fumbles recovered': 0.25882, 'fumbles returned for touchdowns': 0.02353, 'blocked kicks': 0.01176}}, 'PK': {'Defense': {'unassisted tackles': 0.19048, 'assisted tackles': 0.0, 'total tackles': 0.19048, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}, 'Scoring': {'rushing touchdowns': 0.0, 'receiving touchdowns': 0.0, 'return touchdowns': 0.0, 'total touchdowns': 0.0, 'field goals': 20.71429, 'extra points': 26.42857, 'two point conversions': 0.0, 'total points': 88.57143, 'total points per game': 6.58571}, 'Kicking': {'field goals made': 20.71429, 'field goals attempts': 23.85714, 'field goals made pct': 87.11905, 'longest goal made': 53.0, 'field goals from 1 19 yards': 0, 'field goals from 20 29 yards': 0.77778, 'field goals from 30 39 yards': 0.94539, 'field goals from 40 49 yards': 0.77235, 'field goals from 50 yards': 0.57958, 'extra points made': 26.42857, 'extra points attempts': 27.52381, 'extra points made pct': 95.26667}}, 'P': {'Punting': {'punts': 52.4, 'gross punt yards': 2505.45, 'longest punt': 65.8, 'gross punting avg': 47.97, 'net punting avg': 41.84, 'blocked punts': 0.1, 'inside 20 yards punt': 19.8, 'touchbacks': 3.6, 'fair catches': 14.5, 'punts returned': 23.1, 'yards returned on punts': 228.4, 'yards returned on punts avg': 10.415}}, 'QB': {'Passing': {'passing attempts': 204.72093, 'completions': 130.69767, 'completion pct': 58.86744, 'yards': 1408.83721, 'yards per pass avg': 6.1186, 'yards per game': 142.65581, 'longest pass': 48.65116, 'passing touchdowns': 7.83721, 'passing touchdowns pct': 0, 'interceptions': 5.18605, 'interceptions pct': 0, 'sacks': 16.60465, 'sacked yards lost': 109.23256, 'quaterback rating': 75.3}, 'Rushing': {'rushing attempts': 27.93023, 'yards': 120.95349, 'yards per rush avg': 3.51395, 'longest rush': 16.09302, 'over 20 yards': 0.81395, 'rushing touchdowns': 1.37209, 'yards per game': 12.82093, 'fumbles': 1.67442, 'fumbles lost': 0.65116, 'rushing first downs': 9.46512}}, 'LS': {'Defense': {'unassisted tackles': 2.0, 'assisted tackles': 1.07692, 'total tackles': 3.07692, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.15385, 'fumbles recovered': 0.07692, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}}
#{'QB': 43, 'RB': 75, 'FB': 6, 'WR': 113, 'TE': 54, 'C': 9, 'G': 23, 'OT': 16, 'DE': 65, 'DT': 85, 'CB': 125, 'LB': 151, 'S': 85, 'PK': 21, 'P': 20, 'LS': 13}
#2022 {'RB': {'Rushing': {'rushing attempts': 50.47682, 'yards': 219.87417, 'yards per rush avg': 3.64371, 'longest rush': 19.45695, 'over 20 yards': 1.03974, 'rushing touchdowns': 1.45033, 'yards per game': 25.75563, 'fumbles': 0.37086, 'fumbles lost': 0.2053, 'rushing first downs': 11.23179}, 'Receiving': {'receptions': 10.2053, 'receiving targets': 13.3245, 'receiving yards': 75.83444, 'yards per reception avg': 6.65497, 'receiving touchdowns': 0.31788, 'longest reception': 16.49669, 'over 20 yards': 0.58278, 'yards per game': 9.72318, 'fumbles': 0.13907, 'fumbles lost': 0.07947, 'yards after catch': 80.61589, 'receiving first downs': 3.30464}, 'Defense': {'unassisted tackles': 0.75497, 'assisted tackles': 0.27152, 'total tackles': 1.02649, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.00662, 'fumbles recovered': 0.00662, 'fumbles returned for touchdowns': 0.00662, 'blocked kicks': 0.0}, 'Scoring': {'rushing touchdowns': 1.45033, 'receiving touchdowns': 0.31788, 'return touchdowns': 0.00662, 'total touchdowns': 1.77483, 'field goals': 0.0, 'extra points': 0.0, 'two point conversions': 0.07947, 'total points': 10.80795, 'total points per game': 1.46821}, 'Returning': {'kickoff returned attempts': 1.95364, 'kickoff return yards': 46.2649, 'yards per kickoff avg': 6.45563, 'longes kickoff return': 9.36424, 'kickoff return touchdows': 0.00662, 'punts returned': 0.18543, 'yards returned on punts': 1.25828, 'yards per punt avg': 0.25033, 'longest punt return': 0.54967, 'punt return touchdowns': 0.0, 'fair catches': 0.05298}}, 'FB': {'Receiving': {'receptions': 2.16667, 'receiving targets': 3.33333, 'receiving yards': 11.41667, 'yards per reception avg': 3.65, 'receiving touchdowns': 0.08333, 'longest reception': 5.58333, 'over 20 yards': 0.16667, 'yards per game': 0.96667, 'fumbles': 0.08333, 'fumbles lost': 0.0, 'yards after catch': 8.25, 'receiving first downs': 0.41667}, 'Defense': {'unassisted tackles': 2.16667, 'assisted tackles': 0.41667, 'total tackles': 2.58333, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}, 'Returning': {'kickoff returned attempts': 0.33333, 'kickoff return yards': 4.33333, 'yards per kickoff avg': 2.275, 'longes kickoff return': 2.58333, 'kickoff return touchdows': 0.0, 'punts returned': 0.0, 'yards returned on punts': 0.0, 'yards per punt avg': 0.0, 'longest punt return': 0.0, 'punt return touchdowns': 0.0, 'fair catches': 0.0}}, 'WR': {'Receiving': {'receptions': 16.32, 'receiving targets': 26.53778, 'receiving yards': 202.98667, 'yards per reception avg': 10.78978, 'receiving touchdowns': 1.03556, 'longest reception': 27.45333, 'over 20 yards': 2.83111, 'yards per game': 24.65467, 'fumbles': 0.22222, 'fumbles lost': 0.11556, 'yards after catch': 67.56889, 'receiving first downs': 9.68}, 'Defense': {'unassisted tackles': 0.65333, 'assisted tackles': 0.16444, 'total tackles': 0.81778, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.00889, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}, 'Scoring': {'rushing touchdowns': 0.06667, 'receiving touchdowns': 1.06667, 'return touchdowns': 0.01333, 'total touchdowns': 1.14667, 'field goals': 0.0, 'extra points': 0.0, 'two point conversions': 0.05778, 'total points': 6.99556, 'total points per game': 0.90667}, 'Rushing': {'rushing attempts': 1.32, 'yards': 8.27556, 'yards per rush avg': 2.02933, 'longest rush': 4.83111, 'over 20 yards': 0.10222, 'rushing touchdowns': 0.06222, 'yards per game': 0.85956, 'fumbles': 0.02222, 'fumbles lost': 0.01333, 'rushing first downs': 0.44444}}, 'TE': {'Receiving': {'receptions': 13.63551, 'receiving targets': 20.2243, 'receiving yards': 147.4486, 'yards per reception avg': 9.78318, 'receiving touchdowns': 1.11215, 'longest reception': 23.4486, 'over 20 yards': 1.88785, 'yards per game': 18.35701, 'fumbles': 0.1215, 'fumbles lost': 0.04673, 'yards after catch': 71.19626, 'receiving first downs': 7.35514}, 'Defense': {'unassisted tackles': 1.02804, 'assisted tackles': 0.36449, 'total tackles': 1.39252, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.00935, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.02804, 'fumbles recovered': 0.01869, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}, 'C': {'Defense': {'unassisted tackles': 1.0, 'assisted tackles': 0.22222, 'total tackles': 1.22222, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}, 'G': {'Defense': {'unassisted tackles': 1.0, 'assisted tackles': 0.21739, 'total tackles': 1.21739, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}, 'OT': {'Defense': {'unassisted tackles': 0.90909, 'assisted tackles': 0.36364, 'total tackles': 1.27273, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions':ks': 0.0}}, 'DE': {'Defense': {'unassisted tackles': 9.5303, 'assisted tackles': 7.75758, 'total tackles': 17.28788, 'sacks': 1.85985, 'yards lost on sack': 12.13636, 'tackles for loss': 2.59091, 'passes defended': 0.70455, 'interceptions': 0.03788, 'intercepted returned yards': 0.59091, 'longest interception return': 0.02273, 'interceptions returned for touchdowns': 0.00758, 'forced fumbles': 0.2803, 'fumbles recovered': 0.13636, 'fumbles returned for touchdowns': 0.01515, 'blocked kicks': 0.12121}}, 'DT': {'Defense': {'unassisted tackles': 8.3522, 'assisted tackles': 8.06289, 'total tackles': 16.41509, 'sacks': 0.96541, 'yards lost on sack': 5.98742, 'tackles for loss': 1.77987, 'passes defended': 0.61635, 'interceptions': 0.01887, 'intercepted returned yards': 0.01887, 'longest interception return': 0.01887, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.09434, 'fumbles recovered': 0.13836, 'fumbles returned for touchdowns': 0.00629, 'blocked kicks': 0.04403}}, 'LB': {'Defense': {'unassisted tackles': 15.4932, 'assisted tackles': 10.2449, 'total tackles': 25.7381, 'sacks': 0.91497, 'yards lost on sack': 5.88776, 'tackles for loss': 1.93537, 'passes defended': 0.84694, 'interceptions': 0.13265, 'intercepted returned yards': 1.67347, 'longest interception return': 0.10204, 'interceptions returned for touchdowns': 0.02041, 'forced fumbles': 0.28231, 'fumbles recovered': 0.12925, 'fumbles returned for touchdowns': 0.0068, 'blocked kicks': 0.02041}}, 'CB': {'Defense': {'unassisted tackles': 16.52315, 'assisted tackles': 5.34722, 'total tackles': 21.87037, 'sacks': 0.09954, 'yards lost on sack': 0.65741, 'tackles for loss': 0.60185, 'passes defended': 2.86111, 'interceptions': 0.49537, 'intercepted returned yards': 6.25463, 'longest interception return': 0.27315, 'interceptions returned for touchdowns': 0.04167, 'forced fumbles': 0.23148, 'fumbles recovered': 0.14352, 'fumbles returned for touchdowns': 0.01389, 'blocked kicks': 0.01389}}, 'S': {'Defense': {'unassisted tackles': 19.32164, 'assisted tackles': 9.7193, 'total tackles': 29.04094, 'sacks': 0.17836, 'yards lost on sack': 1.1345, 'tackles for loss': 0.69591, 'passes defended': 1.73099, 'interceptions': 0.55556, 'intercepted returned yards': 9.02339, 'longest interception return': 0.23977, 'interceptions returned for touchdowns': 0.05848, 'forced fumbles': 0.24561, 'fumbles recovered': 0.21053, 'fumbles returned for touchdowns': 0.01754, 'blocked kicks': 0.0117}}, 'PK': {'Defense': {'unassisted tackles': 0.26415, 'assisted tackles': 0.18868, 'total tackles': 0.45283, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}, 'Scoring': {'rushing touchdowns': 0.0, 'receiving touchdowns': 0.0, 'return touchdowns': 0.0, 'total touchdowns': 0.0, 'field goals': 11.73585, 'extra points': 12.88679, 'two point conversions': 0.0, 'total points': 48.09434, 'total points per game': 7.05094}, 'Kicking': {'field goals made': 11.73585, 'field goals attempts': 13.66038, 'field goals made pct': 85.13962, 'longest goal made': 45.92453, 'field goals from 1 19 yards': 0.01887, 'field goals from 20 29 yards': 0.76334, 'field goals from 30 39 yards': 0.64073, 'field goals from 40 49 yards': 0.53797, 'field goals from 50 yards': 0.49441, 'extra points made': 12.88679, 'extra points attempts': 13.66038, 'extra points made pct': 89.79434}}, 'P': {'Punting': {'punts': 40.38889, 'gross punt yards': 1893.72222, 'longest punt': 60.47222, 'gross punting avg': 45.00278, 'net punting avg': 39.79722, 'blocked punts': 0.27778, 'inside 20 yards punt': 14.61111, 'touchbacks': 2.72222, 'fair catches': 10.80556, 'punts returned': 17.83333, 'yards returned on punts': 166.72222, 'yards returned on punts avg': 8.53611}}, 'QB': {'Passing': {'passing attempts': 146.57333, 'completions': 91.94667, 'completion pct': 58.84267, 'yards': 999.46667, 'yards per pass avg': 6.48133, 'yards per game': 161.052, 'longest pass': 46.34667, 'passing touchdowns': 5.36, 'passing touchdowns pct': 0, 'interceptions': 3.82667, 'interceptions pct': 0, 'sacks': 11.65333, 'sacked yards lost': 79.08, 'quaterback rating': 77.33333}, 'Rushing': {'rushing attempts': 19.10667, 'yards': 85.49333, 'yards per rush avg': 3.16667, 'longest rush': 13.56, 'over 20 yards': 0.46667, 'rushing touchdowns': 0.77333, 'yards per game': 12.62933, 'fumbles': 1.32, 'fumbles lost': 0.30667, 'rushing first downs': 6.42667}}, 'LS': {'Defense': {'unassisted tackles': 1.25, 'assisted tackles': 1.2, 'total tackles': 2.45, 'sacks': 0.0, 'yards lost on sack': 0.0, 'tackles for loss': 0.0, 'passes defended': 0.0, 'interceptions': 0.0, 'intercepted returned yards': 0.0, 'longest interception return': 0.0, 'interceptions returned for touchdowns': 0.0, 'forced fumbles': 0.0, 'fumbles recovered': 0.0, 'fumbles returned for touchdowns': 0.0, 'blocked kicks': 0.0}}}